<div class=\"flex flex-col h-full w-full\"><div class=\"border-b border-gray-300 p-4\"><div class=\"text-2xl font-bold\" id=\"chatUsername\">
</div>
<div hx-ext=\"ws\" ws-connect=\"
\" class=\"flex-grow overflow-y-auto p-4 space-y-4\" id=\"chatMessages\"></div></div><!-- Input Bar --><div class=\"border-t border-gray-300 p-4 flex items-center\"><button id=\"emojiButton\" class=\"text-gray-400 hover:text-gray-600 mr-2\"><svg class=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M14.828 14.828a4 4 0 005.656 0m-5.656 0a4 4 0 01-5.656 0m5.656 0L12 17.657m0-8a5 5 0 110-10 5 5 0 010 10z\"></path></svg></button><form id=\"chatForm\" class=\"w-full flex flex-grow\" ws-send><textarea id=\"chatInput\" type=\"text\" placeholder=\"Type a message...\" rows=\"2\" class=\"flex-grow p-3 border rounded-lg focus:outline-none focus:ring focus:border-blue-300 resize-none\"></textarea> <button id=\"sendButton\" type=\"button\" class=\"ml-2 bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 justify-end\">Send</button></form></div></div><script>\n\tconst chatId = {data.ChatId};\n\tconst socket = new WebSocket(`ws://localhost:7331/ws?chat_id=${chatId}`);\n\n\tsocket.onmessage = function (event) {\n\t\tconst msg = JSON.parse(event.data);\n\t\tconst messageContainer = document.getElementById('chatMessages');\n\t\tconst newMessage = document.createElement('div');\n\n\t\tif (msg.Client_id == {data.CurrentUser.Id}\n\t\t) {\n\t\t\tnewMessage.innerHTML = `\n                <div class=\"flex justify-end\">\n                    <div class=\"bg-blue-100 p-3 rounded-lg shadow max-w-xs\">\n                        <div class=\"text-sm text-gray-800\">${msg.Text}</div>\n                        <div class=\"text-xs text-gray-500 mt-1\">${msg.Created_at}</div>\n                    </div>\n                </div>`;\n\t\t} else {\n\t\t\tnewMessage.innerHTML = `\n                <div class=\"flex justify-start\">\n                    <div class=\"bg-gray-100 p-3 rounded-lg shadow max-w-xs\">\n                        <div class=\"text-sm text-gray-800\">${msg.Text}</div>\n                        <div class=\"text-xs text-gray-500 mt-1\">${msg.Created_at}</div>\n                    </div>\n                </div>`;\n\t\t}\n\n\t\tmessageContainer.appendChild(newMessage);\n\t\tmessageContainer.scrollTop = messageContainer.scrollHeight;\n\t};\n\n\tdocument.getElementById('sendButton').addEventListener('click', function (event) {\n\t\tevent.preventDefault();\n\t\tconst inputField = document.getElementById('chatInput');\n\t\tconst message = inputField.value;\n\n\t\tif (message.trim() != \"\") {\n\t\t\tconst msg = JSON.stringify({\n\t\t\t\tChat_id: chatId,\n\t\t\t\tClient_id: {data.CurrentUser.Id},\n\t\t\t\tText: message\n\t\t\t});\n\n\t\t\tsocket.send(msg);\n\t\t\tinputField.value = '';\n\t\t\tconsole.log(\"Message sent: \", msg.Text)\n\t\t\tconsole.log(\"For user: \", {data.CurrentUser.Username})\n\t\t}\n\t});\n</script>
